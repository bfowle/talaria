<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>API Reference - Talaria Documentation</title>


        <!-- Custom HTML head -->
        <!-- MathJax Configuration -->
        <script>
        window.MathJax = {
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            processEscapes: true,
            processEnvironments: true
          },
          TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "AMSsymbols.js"]
          }
        };
        </script>
        <meta name="description" content="Intelligent FASTA reduction for aligner index optimization">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "ayu";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Talaria Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Andromeda-Tech/talaria" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/Andromeda-Tech/talaria/edit/main/docs/src/casg/api-reference.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="casg-api-reference"><a class="header" href="#casg-api-reference">CASG API Reference</a></h1>
<p>API reference for the Content-Addressed Sequence Graph (CASG) system as currently implemented in Talaria.</p>
<p><strong>Note</strong>: This document describes the actual implemented API. Some advanced features mentioned in conceptual documentation are planned for future releases.</p>
<h2 id="core-types"><a class="header" href="#core-types">Core Types</a></h2>
<h3 id="sha256hash"><a class="header" href="#sha256hash">SHA256Hash</a></h3>
<p>Content address for all data in CASG.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct SHA256Hash([u8; 32]);

impl SHA256Hash {
    pub fn compute(data: &amp;[u8]) -&gt; Self;
    pub fn from_hex(hex: &amp;str) -&gt; Result&lt;Self&gt;;
    pub fn to_hex(&amp;self) -&gt; String;
    pub fn verify(data: &amp;[u8], expected: &amp;Self) -&gt; bool;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="taxonid"><a class="header" href="#taxonid">TaxonId</a></h3>
<p>NCBI taxonomy identifier.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Clone, Copy, Debug, PartialEq, Eq, Hash)]
pub struct TaxonId(pub u32);

impl TaxonId {
    pub const UNCLASSIFIED: Self = Self(0);
    pub const E_COLI: Self = Self(562);
    pub const HUMAN: Self = Self(9606);
}
<span class="boring">}</span></code></pre></pre>
<h3 id="temporalmanifest"><a class="header" href="#temporalmanifest">TemporalManifest</a></h3>
<p>Main manifest tracking database state with bi-temporal versioning.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct TemporalManifest {
    pub version: String,
    pub created_at: DateTime&lt;Utc&gt;,
    pub sequence_version: String,    // When sequences changed
    pub taxonomy_version: String,    // When taxonomy changed
    pub sequence_root: SHA256Hash,   // Merkle root of sequences
    pub taxonomy_root: SHA256Hash,   // Merkle root of taxonomy
    pub chunk_index: Vec&lt;ChunkMetadata&gt;,
    pub discrepancies: Vec&lt;TaxonomicDiscrepancy&gt;,
    pub etag: Option&lt;String&gt;,
    pub previous_version: Option&lt;String&gt;,
}

impl TemporalManifest {
    pub fn new(seq_ver: &amp;str, tax_ver: &amp;str) -&gt; Self;
    pub fn compute_diff(&amp;self, other: &amp;Self) -&gt; ManifestDiff;
    pub fn verify_integrity(&amp;self) -&gt; Result&lt;()&gt;;
    pub fn to_json(&amp;self) -&gt; Result&lt;String&gt;;
    pub fn from_json(json: &amp;str) -&gt; Result&lt;Self&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="chunkmetadata"><a class="header" href="#chunkmetadata">ChunkMetadata</a></h3>
<p>Metadata for individual chunks.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct ChunkMetadata {
    pub hash: SHA256Hash,
    pub taxon_ids: Vec&lt;TaxonId&gt;,
    pub sequence_count: usize,
    pub byte_size: usize,
    pub compressed_size: Option&lt;usize&gt;,
    pub created_at: DateTime&lt;Utc&gt;,
}
<span class="boring">}</span></code></pre></pre>
<h3 id="taxonomicdiscrepancy"><a class="header" href="#taxonomicdiscrepancy">TaxonomicDiscrepancy</a></h3>
<p>Tracks mismatches between different taxonomy sources.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct TaxonomicDiscrepancy {
    pub accession: String,
    pub header_taxon: Option&lt;TaxonId&gt;,
    pub mapping_taxon: Option&lt;TaxonId&gt;,
    pub taxonomy_taxon: Option&lt;TaxonId&gt;,
    pub resolution: DiscrepancyResolution,
}

pub enum DiscrepancyResolution {
    UseHeader,
    UseMapping,
    UseTaxonomy,
    Manual(TaxonId),
}
<span class="boring">}</span></code></pre></pre>
<h2 id="storage-layer"><a class="header" href="#storage-layer">Storage Layer</a></h2>
<h3 id="casgstorage"><a class="header" href="#casgstorage">CASGStorage</a></h3>
<p>Main storage interface for chunks.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct CASGStorage {
    base_path: PathBuf,
    compression: CompressionType,
}

impl CASGStorage {
    pub fn new(path: PathBuf) -&gt; Result&lt;Self&gt;;
    pub fn store_chunk(&amp;mut self, data: &amp;[u8]) -&gt; Result&lt;SHA256Hash&gt;;
    pub fn get_chunk(&amp;self, hash: &amp;SHA256Hash) -&gt; Result&lt;Vec&lt;u8&gt;&gt;;
    pub fn has_chunk(&amp;self, hash: &amp;SHA256Hash) -&gt; bool;
    pub fn delete_chunk(&amp;mut self, hash: &amp;SHA256Hash) -&gt; Result&lt;()&gt;;
    pub fn get_stats(&amp;self) -&gt; StorageStats;

    // Streaming API
    pub fn get_chunk_stream(&amp;self, hash: &amp;SHA256Hash) -&gt; Result&lt;impl Read&gt;;
    pub fn store_chunk_stream(&amp;mut self, reader: impl Read) -&gt; Result&lt;SHA256Hash&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="storagestats"><a class="header" href="#storagestats">StorageStats</a></h3>
<p>Statistics about storage usage.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct StorageStats {
    pub total_chunks: usize,
    pub total_bytes: u64,
    pub compressed_bytes: u64,
    pub deduplication_ratio: f64,
    pub chunk_size_distribution: HashMap&lt;String, usize&gt;,
}
<span class="boring">}</span></code></pre></pre>
<h2 id="repository-management"><a class="header" href="#repository-management">Repository Management</a></h2>
<h3 id="casgrepository"><a class="header" href="#casgrepository">CASGRepository</a></h3>
<p>Main repository interface for initializing CASG storage.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct CASGRepository {
    storage: CASGStorage,
    manifests: HashMap&lt;String, TemporalManifest&gt;,
}

impl CASGRepository {
    pub fn init(path: &amp;Path) -&gt; Result&lt;Self&gt;;
    pub fn open(path: &amp;Path) -&gt; Result&lt;Self&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="casgdatabasemanager"><a class="header" href="#casgdatabasemanager">CASGDatabaseManager</a></h3>
<p>Manages database operations with CASG storage.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct CASGDatabaseManager {
    base_path: PathBuf,
    storage: CASGStorage,
}

impl CASGDatabaseManager {
    pub fn new(base_path: Option&lt;String&gt;) -&gt; Result&lt;Self&gt;;

    // Download operations (handles both initial and updates)
    pub async fn download(
        &amp;mut self,
        source: &amp;DatabaseSource,
        progress: impl Fn(&amp;str)
    ) -&gt; Result&lt;DownloadResult&gt;;

    // Get statistics
    pub fn get_stats(&amp;self) -&gt; Result&lt;CASGStats&gt;;

    // Check for existing manifest
    pub fn get_manifest(&amp;self, source: &amp;str) -&gt; Result&lt;Option&lt;TemporalManifest&gt;&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="updateinfo"><a class="header" href="#updateinfo">UpdateInfo</a></h3>
<p>Information about available updates.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct UpdateInfo {
    pub current_version: String,
    pub latest_version: String,
    pub new_chunks: Vec&lt;SHA256Hash&gt;,
    pub modified_chunks: Vec&lt;SHA256Hash&gt;,
    pub deleted_chunks: Vec&lt;SHA256Hash&gt;,
    pub download_size: u64,
    pub changes_summary: String,
}
<span class="boring">}</span></code></pre></pre>
<h2 id="merkle-dag"><a class="header" href="#merkle-dag">Merkle DAG</a></h2>
<h3 id="merkledag"><a class="header" href="#merkledag">MerkleDAG</a></h3>
<p>Cryptographic proof structure.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct MerkleDAG {
    root: SHA256Hash,
    nodes: HashMap&lt;SHA256Hash, MerkleNode&gt;,
}

impl MerkleDAG {
    pub fn build_from_chunks(chunks: Vec&lt;Vec&lt;u8&gt;&gt;) -&gt; Result&lt;Self&gt;;
    pub fn compute_root(&amp;self) -&gt; SHA256Hash;
    pub fn generate_proof(&amp;self, data: &amp;[u8]) -&gt; Result&lt;MerkleProof&gt;;
    pub fn verify_proof(proof: &amp;MerkleProof) -&gt; bool;
    pub fn get_depth(&amp;self) -&gt; usize;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="merkleproof"><a class="header" href="#merkleproof">MerkleProof</a></h3>
<p>Proof of membership in Merkle tree.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct MerkleProof {
    pub leaf_hash: SHA256Hash,
    pub root_hash: SHA256Hash,
    pub siblings: Vec&lt;SHA256Hash&gt;,
    pub path: Vec&lt;bool&gt;, // Left = false, Right = true
}

impl MerkleProof {
    pub fn verify(&amp;self) -&gt; bool;
    pub fn to_json(&amp;self) -&gt; Result&lt;String&gt;;
    pub fn from_json(json: &amp;str) -&gt; Result&lt;Self&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h2 id="assembly"><a class="header" href="#assembly">Assembly</a></h2>
<h3 id="fastaassembler"><a class="header" href="#fastaassembler">FastaAssembler</a></h3>
<p>Assembles FASTA files from chunks.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct FastaAssembler&lt;'a&gt; {
    storage: &amp;'a CASGStorage,
    verify: bool,
}

impl&lt;'a&gt; FastaAssembler&lt;'a&gt; {
    pub fn new(storage: &amp;'a CASGStorage) -&gt; Self;
    pub fn with_verification(mut self, verify: bool) -&gt; Self;

    pub fn assemble_from_manifest(
        &amp;self,
        manifest: &amp;TemporalManifest,
        output: &amp;Path
    ) -&gt; Result&lt;()&gt;;

    pub fn assemble_from_chunks(
        &amp;self,
        chunks: &amp;[SHA256Hash]
    ) -&gt; Result&lt;Vec&lt;u8&gt;&gt;;

    pub fn assemble_taxon(
        &amp;self,
        manifest: &amp;TemporalManifest,
        taxon_id: TaxonId,
        output: &amp;Path
    ) -&gt; Result&lt;()&gt;;

    pub fn stream_assembly(
        &amp;self,
        chunks: &amp;[SHA256Hash],
        writer: impl Write
    ) -&gt; Result&lt;()&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h2 id="chunking"><a class="header" href="#chunking">Chunking</a></h2>
<h3 id="taxonomyawarechunker"><a class="header" href="#taxonomyawarechunker">TaxonomyAwareChunker</a></h3>
<p>Smart chunking based on taxonomic relationships.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct TaxonomyAwareChunker {
    target_size: usize,
    min_size: usize,
    max_size: usize,
}

impl TaxonomyAwareChunker {
    pub fn new() -&gt; Self;
    pub fn with_target_size(mut self, size: usize) -&gt; Self;

    pub fn chunk_sequences(
        &amp;self,
        sequences: Vec&lt;Sequence&gt;
    ) -&gt; Result&lt;Vec&lt;TaxonomyAwareChunk&gt;&gt;;

    pub fn rechunk(
        &amp;self,
        chunks: Vec&lt;TaxonomyAwareChunk&gt;
    ) -&gt; Result&lt;Vec&lt;TaxonomyAwareChunk&gt;&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="taxonomyawarechunk"><a class="header" href="#taxonomyawarechunk">TaxonomyAwareChunk</a></h3>
<p>Chunk containing related sequences.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct TaxonomyAwareChunk {
    pub hash: SHA256Hash,
    pub taxon_ids: Vec&lt;TaxonId&gt;,
    pub sequences: Vec&lt;Sequence&gt;,
    pub size: usize,
    pub compressed_size: Option&lt;usize&gt;,
}

impl TaxonomyAwareChunk {
    pub fn from_sequences(sequences: Vec&lt;Sequence&gt;) -&gt; Self;
    pub fn compute_hash(&amp;self) -&gt; SHA256Hash;
    pub fn serialize(&amp;self) -&gt; Result&lt;Vec&lt;u8&gt;&gt;;
    pub fn deserialize(data: &amp;[u8]) -&gt; Result&lt;Self&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h2 id="version-identification"><a class="header" href="#version-identification">Version Identification</a></h2>
<h3 id="versionidentifier"><a class="header" href="#versionidentifier">VersionIdentifier</a></h3>
<p>Identifies which version a FASTA file corresponds to.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct VersionIdentifier {
    repository: CASGRepository,
}

impl VersionIdentifier {
    pub fn new(repo: CASGRepository) -&gt; Self;

    pub fn identify_file(
        &amp;self,
        path: &amp;Path,
        database: Option&lt;&amp;str&gt;
    ) -&gt; Result&lt;VersionInfo&gt;;

    pub fn identify_sequences(
        &amp;self,
        sequences: &amp;[Sequence],
        database: Option&lt;&amp;str&gt;
    ) -&gt; Result&lt;VersionInfo&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="versioninfo"><a class="header" href="#versioninfo">VersionInfo</a></h3>
<p>Version identification result.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub enum VersionInfo {
    Known {
        database: String,
        version: String,
        sequence_version: String,
        taxonomy_version: String,
        merkle_root: SHA256Hash,
    },
    Modified {
        closest_database: String,
        closest_version: String,
        similarity: f64,
        added_sequences: usize,
        removed_sequences: usize,
        modified_sequences: usize,
    },
    Unknown,
}
<span class="boring">}</span></code></pre></pre>
<h2 id="download-results"><a class="header" href="#download-results">Download Results</a></h2>
<h3 id="downloadresult"><a class="header" href="#downloadresult">DownloadResult</a></h3>
<p>Result of database download operation.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub enum DownloadResult {
    /// Database is already up to date
    UpToDate,

    /// Database was updated with incremental changes
    Updated {
        chunks_added: usize,
        chunks_removed: usize,
    },

    /// Initial download completed
    InitialDownload,
}
<span class="boring">}</span></code></pre></pre>
<h3 id="manifeststatus"><a class="header" href="#manifeststatus">ManifestStatus</a></h3>
<p>Status of remote manifest.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub enum ManifestStatus {
    NotModified,
    Updated {
        etag: String,
        last_modified: DateTime&lt;Utc&gt;,
    },
    Error(String),
}
<span class="boring">}</span></code></pre></pre>
<h2 id="statistics"><a class="header" href="#statistics">Statistics</a></h2>
<h3 id="casgstats"><a class="header" href="#casgstats">CASGStats</a></h3>
<p>Repository statistics returned by <code>get_stats()</code>.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct CASGStats {
    pub total_chunks: usize,
    pub total_size: u64,
    pub compressed_chunks: usize,
    pub deduplication_ratio: f64,
    pub database_count: usize,
    pub databases: Vec&lt;DatabaseStats&gt;,
}

pub struct DatabaseStats {
    pub name: String,
    pub version: String,
    pub chunk_count: usize,
    pub total_size: u64,
}
<span class="boring">}</span></code></pre></pre>
<h2 id="error-types"><a class="header" href="#error-types">Error Types</a></h2>
<h3 id="casgerror"><a class="header" href="#casgerror">CASGError</a></h3>
<p>Main error type for CASG operations.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Debug, thiserror::Error)]
pub enum CASGError {
    #[error("Storage error: {0}")]
    Storage(#[from] std::io::Error),

    #[error("Verification failed: expected {expected}, got {actual}")]
    VerificationFailed {
        expected: SHA256Hash,
        actual: SHA256Hash,
    },

    #[error("Chunk not found: {0}")]
    ChunkNotFound(SHA256Hash),

    #[error("Network error: {0}")]
    Network(#[from] reqwest::Error),

    #[error("Manifest error: {0}")]
    Manifest(String),

    #[error("Version conflict: {0}")]
    VersionConflict(String),
}
<span class="boring">}</span></code></pre></pre>
<h2 id="usage-examples"><a class="header" href="#usage-examples">Usage Examples</a></h2>
<h3 id="command-line-usage"><a class="header" href="#command-line-usage">Command Line Usage</a></h3>
<pre><code class="language-bash"># Initialize CASG repository
talaria casg init

# Download database (handles both initial download and updates)
talaria database download uniprot -d swissprot
# Running again will check for updates and only download changes

# Add custom database
talaria database add -i sequences.fasta --source mylab --dataset proteins

# Show repository statistics
talaria casg stats

# List databases
talaria database list

# Get database info
talaria database info uniprot/swissprot

# List sequences in database
talaria database list-sequences uniprot/swissprot --limit 100

# Reduce database
talaria reduce uniprot/swissprot -r 0.3 -o reduced.fasta

# Validate reduction
talaria validate uniprot/swissprot:30-percent

# Reconstruct sequences
talaria reconstruct uniprot/swissprot:30-percent -o reconstructed.fasta
</code></pre>
<h3 id="rust-api-usage"><a class="header" href="#rust-api-usage">Rust API Usage</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use talaria::casg::CASGRepository;
use talaria::core::casg_database_manager::CASGDatabaseManager;

// Initialize repository
let repo = CASGRepository::init("/data/casg")?;

// Create database manager
let mut manager = CASGDatabaseManager::new(Some("/data/casg".to_string()))?;

// Download database (automatically handles updates)
let result = manager.download(&amp;DatabaseSource::UniProt(UniProtDatabase::SwissProt),
                              |msg| println!("{}", msg)).await?;

match result {
    DownloadResult::UpToDate =&gt; println!("Already up to date"),
    DownloadResult::Updated { chunks_added, .. } =&gt;
        println!("Updated: {} new chunks", chunks_added),
    DownloadResult::InitialDownload =&gt; println!("Initial download complete"),
}

// Get statistics
let stats = manager.get_stats()?;
println!("Total chunks: {}", stats.total_chunks);
<span class="boring">}</span></code></pre></pre>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="overview.html">CASG Overview</a> - High-level introduction</li>
<li><a href="architecture.html">Architecture</a> - System design details</li>
<li><a href="troubleshooting.html">Troubleshooting</a> - Common issues and solutions</li>
<li><a href="../api/cli-reference.html#casg">CLI Reference</a> - Command-line interface</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../casg/merkle.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../casg/troubleshooting.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../casg/merkle.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../casg/troubleshooting.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
