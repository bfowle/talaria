<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Architecture - Talaria Documentation</title>


        <!-- Custom HTML head -->
        <!-- MathJax Configuration -->
        <script>
        window.MathJax = {
          tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            processEscapes: true,
            processEnvironments: true
          },
          TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "AMSsymbols.js"]
          }
        };
        </script>
        <meta name="description" content="Intelligent FASTA reduction for aligner index optimization">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "rust";
            const default_dark_theme = "ayu";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Talaria Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Andromeda-Tech/talaria" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/Andromeda-Tech/talaria/edit/main/docs/src/development/architecture.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="architecture"><a class="header" href="#architecture">Architecture</a></h1>
<p>Comprehensive overview of Talaria’s system architecture, design patterns, and internal structure.</p>
<h2 id="system-overview"><a class="header" href="#system-overview">System Overview</a></h2>
<pre class="mermaid">graph TB
    subgraph &quot;CLI Interface&quot;
        A1[reduce]
        A2[stats]
        A3[download]
        A4[interactive]
    end
    
    subgraph &quot;Core Engine&quot;
        B1[Reduction Engine]
        B2[Alignment Manager]
        B3[Delta Encoder]
    end
    
    subgraph &quot;Aligner Abstraction&quot;
        C1[BLAST]
        C2[LAMBDA]
        C3[Kraken]
        C4[Diamond]
        C5[MMseqs2]
    end
    
    subgraph &quot;I/O Layer&quot;
        D1[FASTA Parser]
        D2[Memory Map]
        D3[Compression]
    end
    
    A1 --&gt; B1
    A2 --&gt; B1
    A2 --&gt; B2
    A3 --&gt; D1
    A4 --&gt; B1
    
    B1 --&gt; C1
    B1 --&gt; C2
    B1 --&gt; C3
    B1 --&gt; C4
    B1 --&gt; C5
    
    B2 --&gt; C1
    B2 --&gt; C2
    B2 --&gt; C3
    B2 --&gt; C4
    B2 --&gt; C5
    
    B3 --&gt; D1
    B3 --&gt; D2
    
    C1 --&gt; D1
    C2 --&gt; D1
    C3 --&gt; D1
    C4 --&gt; D1
    C5 --&gt; D1
</pre>
<h2 id="module-structure"><a class="header" href="#module-structure">Module Structure</a></h2>
<h3 id="core-modules"><a class="header" href="#core-modules">Core Modules</a></h3>
<pre><code>src/
├── main.rs              # Entry point and CLI setup
├── lib.rs               # Library exports
│
├── bio/                 # Biological data structures
│   ├── mod.rs           # Module exports
│   ├── sequence.rs      # Sequence representation
│   ├── alignment.rs     # Alignment algorithms
│   ├── scoring.rs       # Scoring matrices
│   ├── delta.rs         # Delta encoding
│   └── stats.rs         # Statistics calculation
│
├── core/                # Core reduction logic
│   ├── mod.rs           # Module exports
│   ├── reducer.rs       # Main reduction engine
│   ├── selector.rs      # Reference selection
│   ├── clustering.rs    # Sequence clustering
│   ├── taxonomy.rs      # Taxonomy-aware reduction
│   └── config.rs        # Configuration management
│
├── aligners/            # Aligner implementations
│   ├── mod.rs           # Aligner trait and registry
│   ├── blast.rs         # BLAST integration
│   ├── lambda.rs        # LAMBDA integration
│   ├── kraken.rs        # Kraken optimization
│   ├── diamond.rs       # Diamond integration
│   └── mmseqs2.rs       # MMseqs2 integration
│
├── io/                  # Input/Output handling
│   ├── mod.rs           # Module exports
│   ├── fasta.rs         # FASTA parser and writer
│   ├── compression.rs   # Compression utilities
│   ├── mmap.rs          # Memory-mapped I/O
│   └── streaming.rs     # Stream processing
│
├── cli/                 # Command-line interface
│   ├── mod.rs           # CLI setup
│   ├── commands/        # Command implementations
│   │   ├── reduce.rs    # Reduce command
│   │   ├── stats.rs     # Statistics command
│   │   ├── download.rs  # Download command
│   │   └── expand.rs    # Expand command
│   ├── interactive/     # Interactive TUI
│   │   ├── mod.rs       # TUI framework
│   │   ├── reduce.rs    # Reduction wizard
│   │   ├── stats.rs     # Statistics viewer
│   │   └── config.rs    # Configuration editor
│   └── visualize.rs     # Visualization utilities
│
├── download/            # Database download
│   ├── mod.rs           # Download manager
│   ├── uniprot.rs       # UniProt downloader
│   ├── ncbi.rs          # NCBI downloader
│   └── pdb.rs           # PDB downloader
│
└── utils/               # Utility functions
    ├── mod.rs           # Module exports
    ├── parallel.rs      # Parallel processing
    ├── progress.rs      # Progress reporting
    └── error.rs         # Error handling
</code></pre>
<h2 id="design-patterns"><a class="header" href="#design-patterns">Design Patterns</a></h2>
<h3 id="1-strategy-pattern-for-aligners"><a class="header" href="#1-strategy-pattern-for-aligners">1. Strategy Pattern for Aligners</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait Aligner: Send + Sync {
    fn align(&amp;self, seq1: &amp;[u8], seq2: &amp;[u8]) -&gt; AlignmentResult;
    fn optimization_hints(&amp;self) -&gt; OptimizationHints;
}

pub struct AlignerRegistry {
    aligners: HashMap&lt;String, Box&lt;dyn Aligner&gt;&gt;,
}

impl AlignerRegistry {
    pub fn get_aligner(&amp;self, name: &amp;str) -&gt; Option&lt;&amp;dyn Aligner&gt; {
        self.aligners.get(name).map(|b| b.as_ref())
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="2-builder-pattern-for-configuration"><a class="header" href="#2-builder-pattern-for-configuration">2. Builder Pattern for Configuration</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct ReductionBuilder {
    config: ReductionConfig,
}

impl ReductionBuilder {
    pub fn new() -&gt; Self {
        Self {
            config: ReductionConfig::default(),
        }
    }
    
    pub fn threshold(mut self, threshold: f64) -&gt; Self {
        self.config.threshold = threshold;
        self
    }
    
    pub fn aligner(mut self, aligner: String) -&gt; Self {
        self.config.aligner = aligner;
        self
    }
    
    pub fn build(self) -&gt; Result&lt;ReductionEngine&gt; {
        ReductionEngine::new(self.config)
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="3-iterator-pattern-for-streaming"><a class="header" href="#3-iterator-pattern-for-streaming">3. Iterator Pattern for Streaming</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct FastaIterator&lt;R: BufRead&gt; {
    reader: R,
    buffer: String,
}

impl&lt;R: BufRead&gt; Iterator for FastaIterator&lt;R&gt; {
    type Item = Result&lt;Sequence&gt;;
    
    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {
        // Parse next sequence
    }
}

pub trait StreamProcessor {
    fn process_stream&lt;I&gt;(&amp;self, iter: I) -&gt; Result&lt;()&gt;
    where
        I: Iterator&lt;Item = Result&lt;Sequence&gt;&gt;;
}
<span class="boring">}</span></code></pre></pre>
<h3 id="4-observer-pattern-for-progress"><a class="header" href="#4-observer-pattern-for-progress">4. Observer Pattern for Progress</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait ProgressObserver: Send + Sync {
    fn on_progress(&amp;self, current: usize, total: usize);
    fn on_complete(&amp;self);
    fn on_error(&amp;self, error: &amp;Error);
}

pub struct ProgressManager {
    observers: Vec&lt;Box&lt;dyn ProgressObserver&gt;&gt;,
}

impl ProgressManager {
    pub fn notify_progress(&amp;self, current: usize, total: usize) {
        for observer in &amp;self.observers {
            observer.on_progress(current, total);
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="data-flow"><a class="header" href="#data-flow">Data Flow</a></h2>
<h3 id="reduction-pipeline"><a class="header" href="#reduction-pipeline">Reduction Pipeline</a></h3>
<pre class="mermaid">flowchart TD
    A[Input FASTA] --&gt; B[Parse &amp; Load]
    B --&gt;|Memory-mapped for large files| C[Pre-filtering]
    C --&gt;|Length, complexity filters| D[Clustering]
    D --&gt;|Group similar sequences| E[Reference Select]
    E --&gt;|Choose representatives| F{Skip Deltas?}
    F --&gt;|No| G[Delta Encoding]
    F --&gt;|Yes --no-deltas| H[Write Output]
    G --&gt;|Encode non-references| H[Write Output]
    H --&gt; I[FASTA + Delta files]
    
    style F fill:#f9f,stroke:#333,stroke-width:2px
    style G fill:#bbf,stroke:#333,stroke-width:2px
</pre>
<h3 id="alignment-processing"><a class="header" href="#alignment-processing">Alignment Processing</a></h3>
<pre class="mermaid">flowchart TD
    A[Query Sequences] --&gt; B[Batch Manager]
    B --&gt; C1[Thread 1]
    B --&gt; C2[Thread 2]
    B --&gt; CN[Thread N]
    
    C1 --&gt; D1[Aligner]
    C2 --&gt; D2[Aligner]
    CN --&gt; DN[Aligner]
    
    D1 --&gt; E[Cache]
    D2 --&gt; E
    DN --&gt; E
    
    E --&gt; F[Results]
    
    style B fill:#f96,stroke:#333,stroke-width:2px
    style E fill:#9f9,stroke:#333,stroke-width:2px
</pre>
<h2 id="memory-management"><a class="header" href="#memory-management">Memory Management</a></h2>
<h3 id="memory-layout"><a class="header" href="#memory-layout">Memory Layout</a></h3>
<pre class="mermaid">graph TB
    subgraph &quot;Application Memory&quot;
        A[&quot;Stack (per thread)&lt;br/&gt;• Function calls&lt;br/&gt;• Local variables&quot;]
        B[&quot;Heap&lt;br/&gt;• Sequence buffers&lt;br/&gt;• Alignment matrices&lt;br/&gt;• Cache structures&quot;]
        C[&quot;Memory-Mapped Regions&lt;br/&gt;• Large FASTA files&lt;br/&gt;• Read-only mapping&lt;br/&gt;• Page-aligned access&quot;]
        D[&quot;Shared Memory&lt;br/&gt;• Inter-process communication&lt;br/&gt;• Alignment cache&lt;br/&gt;• Progress tracking&quot;]
    end
    
    A -.-&gt;|Thread-local| B
    B -.-&gt;|Dynamic allocation| C
    C -.-&gt;|Shared access| D
    
    style A fill:#ffd,stroke:#333,stroke-width:2px
    style B fill:#dff,stroke:#333,stroke-width:2px
    style C fill:#fdf,stroke:#333,stroke-width:2px
    style D fill:#dfd,stroke:#333,stroke-width:2px
</pre>
<h3 id="object-pooling"><a class="header" href="#object-pooling">Object Pooling</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct AlignmentMatrixPool {
    available: Vec&lt;AlignmentMatrix&gt;,
    in_use: HashSet&lt;usize&gt;,
}

impl AlignmentMatrixPool {
    pub fn acquire(&amp;mut self, rows: usize, cols: usize) -&gt; PooledMatrix {
        let matrix = self.available.pop()
            .unwrap_or_else(|| AlignmentMatrix::new(rows, cols));
        PooledMatrix::new(matrix, self)
    }
    
    pub fn release(&amp;mut self, matrix: AlignmentMatrix) {
        if self.available.len() &lt; MAX_POOL_SIZE {
            self.available.push(matrix);
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="concurrency-model"><a class="header" href="#concurrency-model">Concurrency Model</a></h2>
<h3 id="thread-pool-architecture"><a class="header" href="#thread-pool-architecture">Thread Pool Architecture</a></h3>
<pre class="mermaid">flowchart TD
    A[&quot;Main Thread&lt;br/&gt;CLI parsing, coordination&quot;] --&gt; B[Producer Queue]
    A --&gt; C[Consumer Queue]
    
    B --&gt; D1[Worker 1]
    B --&gt; D2[Worker 2]
    B --&gt; D3[Worker 3]
    B --&gt; DN[Worker N]
    
    D1 --&gt; C
    D2 --&gt; C
    D3 --&gt; C
    DN --&gt; C
    
    style A fill:#f9f,stroke:#333,stroke-width:3px
    style B fill:#9ff,stroke:#333,stroke-width:2px
    style C fill:#ff9,stroke:#333,stroke-width:2px
</pre>
<h3 id="synchronization-primitives"><a class="header" href="#synchronization-primitives">Synchronization Primitives</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct SharedState {
    // Read-heavy data
    config: RwLock&lt;Config&gt;,
    
    // Write-heavy data
    progress: Mutex&lt;Progress&gt;,
    
    // Lock-free structures
    stats: AtomicU64,
    
    // Channel communication
    results: mpsc::Sender&lt;Result&gt;,
}
<span class="boring">}</span></code></pre></pre>
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<h3 id="error-hierarchy"><a class="header" href="#error-hierarchy">Error Hierarchy</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Debug, thiserror::Error)]
pub enum TalariaError {
    #[error("I/O error: {0}")]
    Io(#[from] std::io::Error),
    
    #[error("Parse error: {0}")]
    Parse(String),
    
    #[error("Alignment error: {0}")]
    Alignment(String),
    
    #[error("Configuration error: {0}")]
    Config(String),
    
    #[error("Download error: {0}")]
    Download(#[from] reqwest::Error),
}

pub type Result&lt;T&gt; = std::result::Result&lt;T, TalariaError&gt;;
<span class="boring">}</span></code></pre></pre>
<h3 id="error-recovery"><a class="header" href="#error-recovery">Error Recovery</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait ErrorRecovery {
    fn recover(&amp;self, error: &amp;TalariaError) -&gt; RecoveryAction;
}

pub enum RecoveryAction {
    Retry,
    Skip,
    Abort,
    Fallback(Box&lt;dyn Fn() -&gt; Result&lt;()&gt;&gt;),
}
<span class="boring">}</span></code></pre></pre>
<h2 id="plugin-system"><a class="header" href="#plugin-system">Plugin System</a></h2>
<h3 id="plugin-interface"><a class="header" href="#plugin-interface">Plugin Interface</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait Plugin: Send + Sync {
    fn name(&amp;self) -&gt; &amp;str;
    fn version(&amp;self) -&gt; &amp;str;
    fn initialize(&amp;mut self, config: &amp;Config) -&gt; Result&lt;()&gt;;
    fn execute(&amp;self, context: &amp;mut Context) -&gt; Result&lt;()&gt;;
}

pub struct PluginManager {
    plugins: Vec&lt;Box&lt;dyn Plugin&gt;&gt;,
    hooks: HashMap&lt;String, Vec&lt;PluginHook&gt;&gt;,
}
<span class="boring">}</span></code></pre></pre>
<h3 id="hook-points"><a class="header" href="#hook-points">Hook Points</a></h3>
<pre class="mermaid">flowchart LR
    A[Application Start] --&gt; B[pre_init]
    B --&gt; C[post_init]
    C --&gt; D[pre_reduction]
    D --&gt; E[Reduction Process]
    E --&gt; F[post_reduction]
    F --&gt; G[pre_alignment]
    G --&gt; H[Alignment Process]
    H --&gt; I[post_alignment]
    I --&gt; J[pre_output]
    J --&gt; K[Write Output]
    K --&gt; L[post_output]
    L --&gt; M[Application End]
    
    style E fill:#bbf,stroke:#333,stroke-width:2px
    style H fill:#bbf,stroke:#333,stroke-width:2px
    style K fill:#bbf,stroke:#333,stroke-width:2px
</pre>
<h2 id="testing-architecture"><a class="header" href="#testing-architecture">Testing Architecture</a></h2>
<h3 id="test-structure"><a class="header" href="#test-structure">Test Structure</a></h3>
<pre><code>tests/
├── unit/               # Unit tests
│   ├── alignment_test.rs
│   ├── delta_test.rs
│   └── parser_test.rs
│
├── integration/        # Integration tests
│   ├── reduce_test.rs
│   ├── download_test.rs
│   └── cli_test.rs
│
├── fixtures/           # Test data
│   ├── small.fasta
│   ├── large.fasta
│   └── edge_cases.fasta
│
└── benchmarks/         # Performance tests
    ├── alignment_bench.rs
    ├── parsing_bench.rs
    └── reduction_bench.rs
</code></pre>
<h3 id="testing-strategy"><a class="header" href="#testing-strategy">Testing Strategy</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[cfg(test)]
mod tests {
    use super::*;
    use proptest::prelude::*;
    
    // Property-based testing
    proptest! {
        #[test]
        fn test_alignment_symmetry(seq1 in sequence_strategy(),
                                   seq2 in sequence_strategy()) {
            let score1 = align(&amp;seq1, &amp;seq2);
            let score2 = align(&amp;seq2, &amp;seq1);
            prop_assert_eq!(score1, score2);
        }
    }
    
    // Fuzz testing
    #[test]
    fn fuzz_parser() {
        let data = include_bytes!("../fuzz/corpus/parser/crash-1");
        let _ = parse_fasta(data);
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="performance-considerations"><a class="header" href="#performance-considerations">Performance Considerations</a></h2>
<h3 id="hot-paths"><a class="header" href="#hot-paths">Hot Paths</a></h3>
<ol>
<li><strong>Alignment Inner Loop</strong>: SIMD-optimized</li>
<li><strong>FASTA Parsing</strong>: Zero-copy parsing</li>
<li><strong>Delta Encoding</strong>: Bit-packed representation</li>
<li><strong>Cache Lookup</strong>: Lock-free hash maps</li>
</ol>
<h3 id="optimization-techniques"><a class="header" href="#optimization-techniques">Optimization Techniques</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Branch prediction hints
#[inline(always)]
#[cold]
fn handle_error(e: Error) { /* ... */ }

// Cache-friendly data layout
#[repr(C, align(64))]
struct CacheAligned {
    data: [u8; 64],
}

// SIMD operations
#[target_feature(enable = "avx2")]
unsafe fn simd_compare(a: &amp;[u8], b: &amp;[u8]) -&gt; u32 {
    // AVX2 implementation
}
<span class="boring">}</span></code></pre></pre>
<h2 id="security-considerations"><a class="header" href="#security-considerations">Security Considerations</a></h2>
<h3 id="input-validation"><a class="header" href="#input-validation">Input Validation</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct InputValidator {
    max_sequence_length: usize,
    max_file_size: usize,
    allowed_characters: HashSet&lt;u8&gt;,
}

impl InputValidator {
    pub fn validate(&amp;self, input: &amp;[u8]) -&gt; Result&lt;()&gt; {
        if input.len() &gt; self.max_file_size {
            return Err(TalariaError::InvalidInput("File too large"));
        }
        // Additional validation
        Ok(())
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="sandboxing"><a class="header" href="#sandboxing">Sandboxing</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[cfg(target_os = "linux")]
pub fn setup_sandbox() -&gt; Result&lt;()&gt; {
    use syscallz::{Context, Syscall, Action};
    
    let mut ctx = Context::init()?;
    ctx.allow_syscall(Syscall::read)?;
    ctx.allow_syscall(Syscall::write)?;
    ctx.allow_syscall(Syscall::mmap)?;
    // Restrict other syscalls
    ctx.load()?;
    
    Ok(())
}
<span class="boring">}</span></code></pre></pre>
<h2 id="future-architecture"><a class="header" href="#future-architecture">Future Architecture</a></h2>
<h3 id="planned-enhancements"><a class="header" href="#planned-enhancements">Planned Enhancements</a></h3>
<ol>
<li><strong>Distributed Processing</strong>: MPI support</li>
<li><strong>Cloud Integration</strong>: S3/GCS backends</li>
<li><strong>GPU Acceleration</strong>: CUDA/OpenCL kernels</li>
<li><strong>Web Assembly</strong>: Browser-based version</li>
<li><strong>gRPC API</strong>: Remote procedure calls</li>
</ol>
<h3 id="extensibility-points"><a class="header" href="#extensibility-points">Extensibility Points</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait Extension {
    fn extend_cli(&amp;self, app: App) -&gt; App;
    fn extend_config(&amp;self, config: &amp;mut Config);
    fn extend_pipeline(&amp;self, pipeline: &amp;mut Pipeline);
}
<span class="boring">}</span></code></pre></pre>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="building.html">Building</a> - Build instructions</li>
<li><a href="contributing.html">Contributing</a> - Development guidelines</li>
<li><a href="../api/lib.html">API Reference</a> - Library documentation</li>
<li><a href="../advanced/performance.html">Performance</a> - Optimization guide</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../development/contributing.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../development/contributing.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
